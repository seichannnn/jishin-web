<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>最新地震・津波情報マップ</title>
    <meta property="og:title" content="最新地震・津波情報マップ">
    <meta property="og:description" content="国内の最新地震・津波情報を可視化。">
    <meta property="og:type" content="website">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">
    <style>
        :root { --bg-dark: #121212; --panel-bg: rgba(20, 25, 35, 0.85); --panel-border: rgba(255, 255, 255, 0.15); --text-primary: #ffffff; --text-secondary: #b0b0b0; --accent-color: #3b82f6; --danger-color: #ef4444; --font-main: 'Noto Sans JP', sans-serif; --font-mono: 'Roboto Mono', monospace; }
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; font-family: var(--font-main); background-color: var(--bg-dark); color: var(--text-primary); overflow: hidden; }
        #map { height: 100%; width: 100%; z-index: 1; background: #1a1a1a; }
        .leaflet-tile-pane { filter: grayscale(20%) brightness(95%); }
        @keyframes popIn { 0% { transform: scale(0); opacity: 0; } 60% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes pulse-red { 0% { box-shadow: 0 0 0 0 rgba(230, 0, 0, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(230, 0, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(230, 0, 0, 0); } }
        @keyframes pulse-yellow { 0% { box-shadow: 0 0 0 0 rgba(255, 200, 0, 0.7); } 70% { box-shadow: 0 0 0 8px rgba(255, 200, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 200, 0, 0); } }
        @keyframes ripple { 0% { width: 0; height: 0; opacity: 0.8; border-width: 4px; } 100% { width: 80px; height: 80px; opacity: 0; border-width: 0; } }
        @keyframes slideInLeft { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slideInRightItem { from { transform: translateX(30px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes flashText { 0% { color: var(--text-primary); text-shadow: none; } 30% { color: #fff; text-shadow: 0 0 8px #fff, 0 0 12px var(--accent-color); } 100% { color: var(--text-primary); text-shadow: none; } }
        @keyframes modalPopUp { 0% { opacity: 0; transform: scale(0.9) translateY(20px); filter: blur(10px); } 100% { opacity: 1; transform: scale(1) translateY(0); filter: blur(0); } }
        .glass-panel { background: var(--panel-bg); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid var(--panel-border); box-shadow: 0 10px 25px -5px rgba(0,0,0,0.5); border-radius: 12px; }
        .ui-btn { background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); color: var(--text-primary); padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 700; transition: all 0.2s ease; backdrop-filter: blur(4px); }
        .ui-btn:hover { background: rgba(255, 255, 255, 0.2); transform: translateY(-1px); } .ui-btn:active { transform: translateY(0); }
        .epicenter-marker { position: relative; display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; }
        .epicenter-center { font-size: 28px; color: #ff3333; font-weight: bold; text-shadow: 0 0 10px rgba(255, 0, 0, 0.8); z-index: 2; line-height: 1; }
        .epicenter-ripple { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 50%; border: 2px solid #ff3333; box-shadow: 0 0 10px #ff3333; animation: ripple 2s infinite ease-out; pointer-events: none; }
        .epicenter-ripple:nth-child(2) { animation-delay: 0.6s; }
        .seismic-icon { display: flex; align-items: center; justify-content: center; border-radius: 50%; font-family: var(--font-mono); font-weight: 700; font-size: 14px; color: #fff; box-shadow: 0 4px 6px rgba(0,0,0,0.4); border: 2px solid rgba(255, 255, 255, 0.9); opacity: 0; transform: scale(0); animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        .seismic-icon:hover { transform: scale(1.3) !important; z-index: 1000 !important; cursor: pointer; }
        .intensity-1 { background-color: #6085c9; } .intensity-2 { background-color: #2679d6; } .intensity-3 { background-color: #2bba2b; } .intensity-4 { background-color: #f0cc00; color: #222; text-shadow: none; }
        .intensity-5-minus { background-color: #ffaa00; color: #222; text-shadow: none; animation: popIn 0.5s forwards, pulse-yellow 2s infinite 1s; }
        .intensity-5-plus { background-color: #ff7300; animation: popIn 0.5s forwards, pulse-yellow 2s infinite 1s; }
        .intensity-6-minus { background-color: #e60000; animation: popIn 0.5s forwards, pulse-red 2s infinite 1s; }
        .intensity-6-plus { background-color: #a60021; animation: popIn 0.5s forwards, pulse-red 2s infinite 1s; }
        .intensity-7 { background-color: #9c005b; animation: popIn 0.5s forwards, pulse-red 2s infinite 1s; }
        .intensity-unknown { background-color: #666; }
        .info-panel { position: absolute; top: 20px; left: 20px; z-index: 1000; padding: 20px; width: 320px; max-width: 90%; max-height: 85vh; overflow-y: auto; border-left: 6px solid var(--text-secondary); transition: border-color 0.3s ease; animation: slideInLeft 0.5s ease-out; }
        .info-panel h1 { margin: 0 0 10px 0; font-size: 20px; font-weight: 700; letter-spacing: 0.05em; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--panel-border); padding-bottom: 10px; }
        .source-credit { font-size: 10px; color: var(--text-secondary); margin-bottom: 15px; line-height: 1.4; }
        .info-row { display: flex; justify-content: space-between; align-items: baseline; padding: 8px 0; border-bottom: 1px dashed rgba(255,255,255,0.1); }
        .info-row:last-child { border-bottom: none; }
        .info-label { color: var(--text-secondary); font-size: 12px; font-weight: 500; }
        .info-value { font-weight: 700; text-align: right; font-size: 15px; }
        .info-value.updated { animation: flashText 0.6s ease-out; }
        .max-intensity { font-size: 1.6em; font-family: var(--font-mono); letter-spacing: -0.05em; }
        .tsunami-area-list { margin-top: 15px; border-top: 1px solid var(--panel-border); padding-top: 10px; }
        .tsunami-row { padding: 6px 0; border-bottom: 1px dashed rgba(255,255,255,0.1); font-size: 13px; display: flex; align-items: center; }
        .tsunami-grade { display: inline-block; padding: 2px 8px; border-radius: 4px; color: white; font-weight: bold; font-size: 10px; margin-right: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        .grade-major { background: linear-gradient(135deg, #9c27b0, #6a1b9a); }
        .grade-warning { background: linear-gradient(135deg, #f44336, #c62828); }
        .grade-watch { background: linear-gradient(135deg, #ffeb3b, #fbc02d); color: #222; }
        .grade-unknown { background: #666; }
        #loading { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(18, 18, 18, 0.9); z-index: 2000; display: flex; justify-content: center; align-items: center; font-weight: bold; color: var(--text-primary); flex-direction: column; backdrop-filter: blur(5px); }
        .loading-spinner { width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.1); border-top-color: var(--accent-color); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 15px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .legend { position: absolute; bottom: 30px; right: 20px; z-index: 1000; padding: 12px; width: 140px; }
        .legend-title { font-weight: bold; margin-bottom: 8px; text-align: center; font-size: 11px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px; }
        .legend-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }
        .legend-item { display: flex; align-items: center; justify-content: center; height: 30px; border-radius: 6px; font-weight: bold; font-size: 12px; font-family: var(--font-mono); box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .refresh-btn { margin-top: 15px; width: 100%; background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(37, 99, 235, 0.3)); border-color: rgba(59, 130, 246, 0.4); }
        .refresh-btn:hover { background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(37, 99, 235, 0.4)); }
        .header-buttons { position: absolute; top: 20px; right: 20px; z-index: 1100; display: flex; gap: 10px; }
        .history-panel { position: absolute; top: 0; right: -340px; width: 320px; height: 100%; z-index: 1200; transition: right 0.4s cubic-bezier(0.19, 1, 0.22, 1); display: flex; flex-direction: column; border-radius: 12px 0 0 12px; border-right: none; }
        .history-panel.open { right: 0; box-shadow: -10px 0 30px rgba(0,0,0,0.5); }
        .history-header { padding: 20px; border-bottom: 1px solid var(--panel-border); font-weight: bold; display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.02); }
        .close-history-btn { background: none; border: none; font-size: 24px; cursor: pointer; color: var(--text-secondary); transition: color 0.2s; }
        .close-history-btn:hover { color: var(--text-primary); }
        .history-list { flex: 1; overflow-y: auto; padding: 10px; }
        .history-item { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; border-radius: 8px; transition: background 0.2s; margin-bottom: 8px; background: rgba(255,255,255,0.02); opacity: 0; transform: translateX(30px); animation: slideInRightItem 0.4s ease-out forwards; }
        .history-item:hover { background: rgba(255,255,255,0.08); }
        .history-item.active { background: linear-gradient(90deg, rgba(59, 130, 246, 0.15), transparent); border-left: 3px solid var(--accent-color); }
        .history-time { font-size: 11px; color: var(--text-secondary); font-family: var(--font-mono); }
        .history-name { font-weight: 700; font-size: 14px; margin: 4px 0; color: var(--text-primary); }
        .history-meta { font-size: 11px; display: flex; justify-content: space-between; align-items: center; margin-top: 6px; }
        .history-shindo-badge { padding: 3px 8px; border-radius: 4px; color: white; font-weight: bold; font-size: 10px; font-family: var(--font-mono); box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .tsunami-badge { background-color: #1e3a8a; border: 1px solid #3b82f6; }
        .modal-overlay { display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(8px); z-index: 2000; justify-content: center; align-items: center; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease; }
        .modal-overlay.open { opacity: 1; visibility: visible; }
        .modal-content { padding: 30px; max-width: 500px; width: 90%; position: relative; opacity: 0; transform: scale(0.9) translateY(20px); filter: blur(10px); transition: opacity 0.4s ease, transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), filter 0.4s ease; }
        .modal-overlay.open .modal-content { opacity: 1; transform: scale(1) translateY(0); filter: blur(0); }
        .close-modal-btn { position: absolute; top: 15px; right: 20px; font-size: 28px; cursor: pointer; color: var(--text-secondary); transition: color 0.2s; }
        .close-modal-btn:hover { color: var(--text-primary); }
        .modal-content h2 { margin-top: 0; color: var(--text-primary); border-bottom: 1px solid var(--panel-border); padding-bottom: 15px; font-size: 1.5em; }
        .modal-content p { line-height: 1.7; color: #d1d5db; font-size: 0.95em; }
        .modal-content ul { background: rgba(255,255,255,0.03); padding: 15px 15px 15px 35px; border-radius: 8px; color: #d1d5db; }
        .creator-credit { margin-top: 25px; padding-top: 15px; border-top: 1px dashed var(--panel-border); text-align: right; font-weight: bold; color: var(--text-secondary); font-family: var(--font-mono); letter-spacing: 1px; font-size: 0.9em; }

        @media (max-width: 600px) {
            .info-panel { width: calc(100% - 20px); left: 10px; right: auto; top: auto; bottom: 20px; max-height: 40vh; padding: 12px; background: rgba(20, 25, 35, 0.98); border-radius: 16px; }
            .info-panel h1 { font-size: 16px; margin-bottom: 8px; padding-bottom: 8px; }
            .info-label { font-size: 11px; }
            .info-value { font-size: 14px; }
            .max-intensity { font-size: 1.5em; }
            .info-row { padding: 4px 0; }
            .refresh-btn { margin-top: 10px; padding: 10px; font-size: 12px; }
            .header-buttons { top: 15px; right: 15px; gap: 8px; }
            .ui-btn { padding: 10px 14px; font-size: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); background: rgba(20, 25, 35, 0.95); }
            .history-panel { width: 100%; right: -100%; border-radius: 0; background: rgba(18, 18, 18, 0.98); }
            .history-header { padding: 15px; }
            .legend { top: 15px; left: 15px; bottom: auto; right: auto; width: auto; padding: 6px; transform: scale(0.85); transform-origin: top left; background: rgba(20, 25, 35, 0.9); border-radius: 8px; }
            .legend-grid { gap: 3px; }
            .legend-item { width: 22px; height: 22px; font-size: 10px; }
            .modal-content { width: 85%; padding: 20px; max-height: 80vh; overflow-y: auto; }
            .modal-content h2 { font-size: 1.3em; }
        }
    </style>
</head>
<body>
    <div id="loading"><div class="loading-spinner"></div><div>Loading Data...</div></div>
    <div id="map"></div>
    <div class="header-buttons"><button class="ui-btn" onclick="toggleAbout()">ABOUT</button><button class="ui-btn" onclick="toggleHistory()">履歴</button></div>
    <div id="aboutModal" class="modal-overlay" onclick="toggleAbout()">
        <div class="modal-content glass-panel" onclick="event.stopPropagation()">
            <span class="close-modal-btn" onclick="toggleAbout()">×</span>
            <h2>About This Map</h2>
            <p>気象庁のデータを元にした最新の地震・津波情報を、地図上でリアルタイムに確認できるWebアプリです。</p>
            <p><strong>機能・特徴：</strong></p><ul><li>最新の地震情報（震度分布）の可視化</li><li>津波予報の表示</li><li>過去の地震履歴の閲覧</li><li>SF風ダークグラスモーフィズムデザイン</li></ul>
            <p style="font-size:0.85em; color:var(--text-secondary);">※ データ出典：気象庁、防災科学技術研究所 (via P2PQuake API)<br>※ 実際の避難行動は公式情報に従ってください。</p>
            <div class="creator-credit">Created by seichan</div>
        </div>
    </div>
    <div class="history-panel glass-panel" id="historyPanel">
        <div class="history-header">履歴一覧 <button class="close-history-btn" onclick="toggleHistory()">×</button></div>
        <div class="history-list" id="historyList"></div>
    </div>
    <div class="info-panel glass-panel" id="infoPanel">
        <h1>EARTHQUAKE</h1>
        <div class="source-credit">DATA: JMA, NIED via P2PQuake API</div>
        <div class="info-details" id="infoContent"><div style="padding: 20px; text-align: center; color: var(--text-secondary);">Waiting for data...</div></div>
        <button class="ui-btn refresh-btn" onclick="fetchLatestQuake()">最新情報に更新</button>
    </div>
    <div class="legend glass-panel">
        <div class="legend-title">JMA SEISMIC SCALE</div>
        <div class="legend-grid">
            <div class="legend-item intensity-1">1</div><div class="legend-item intensity-2">2</div><div class="legend-item intensity-3">3</div>
            <div class="legend-item intensity-4">4</div><div class="legend-item intensity-5-minus">5-</div><div class="legend-item intensity-5-plus">5+</div>
            <div class="legend-item intensity-6-minus">6-</div><div class="legend-item intensity-6-plus">6+</div><div class="legend-item intensity-7">7</div>
        </div>
    </div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <script>
        const map = L.map('map', { zoomControl: false }).setView([36.5, 138.0], 5);
        L.control.zoom({ position: 'bottomright' }).addTo(map);
        L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png', { attribution: "<a href='https://maps.gsi.go.jp/development/ichiran.html' target='_blank' style='color:#aaa;'>国土地理院</a>", maxZoom: 18, minZoom: 4 }).addTo(map);
        let markerLayer = L.layerGroup().addTo(map);
        let epicenterLayer = L.layerGroup().addTo(map);

        const locationMap = {
            "北海道": [43.06, 141.35], "青森県": [40.82, 140.74], "岩手県": [39.70, 141.15], "宮城県": [38.26, 140.87], "秋田県": [39.72, 140.10], "山形県": [38.25, 140.33], "福島県": [37.76, 140.47], "茨城県": [36.36, 140.47], "栃木県": [36.55, 139.88], "群馬県": [36.38, 139.06], "埼玉県": [35.86, 139.64], "千葉県": [35.60, 140.12], "東京都": [35.68, 139.76], "神奈川県": [35.44, 139.63], "新潟県": [37.91, 139.02], "富山県": [36.69, 137.21], "石川県": [36.56, 136.65], "福井県": [36.06, 136.22], "山梨県": [35.66, 138.56], "長野県": [36.64, 138.18], "岐阜県": [35.42, 136.75], "静岡県": [34.97, 138.38], "愛知県": [35.18, 136.90], "三重県": [34.71, 136.50], "滋賀県": [35.01, 135.85], "京都府": [35.01, 135.76], "大阪府": [34.69, 135.50], "兵庫県": [34.69, 135.19], "奈良県": [34.68, 135.80], "和歌山県": [34.23, 135.17], "鳥取県": [35.50, 134.23], "島根県": [35.46, 133.04], "岡山県": [34.65, 133.91], "広島県": [34.38, 132.45], "山口県": [34.17, 131.47], "徳島県": [34.07, 134.55], "香川県": [34.34, 134.04], "愛媛県": [33.83, 132.76], "高知県": [33.55, 133.53], "福岡県": [33.60, 130.41], "佐賀県": [33.26, 130.30], "長崎県": [32.75, 129.87], "熊本県": [32.80, 130.70], "大分県": [33.23, 131.60], "宮崎県": [31.90, 131.42], "鹿児島県": [31.59, 130.55], "沖縄県": [26.21, 127.68],
            "札幌市": [43.06, 141.35], "函館市": [41.76, 140.73], "小樽市": [43.19, 141.00], "旭川市": [43.77, 142.36], "室蘭市": [42.31, 140.97], "釧路市": [42.98, 144.38], "帯広市": [42.92, 143.19], "北見市": [43.80, 143.89], "夕張市": [43.05, 141.97], "岩見沢市": [43.20, 141.77], "網走市": [44.02, 144.26], "留萌市": [43.94, 141.65], "苫小牧市": [42.63, 141.60], "稚内市": [45.41, 141.67], "江別市": [43.10, 141.53], "根室市": [43.33, 145.58], "千歳市": [42.82, 141.65], "登別市": [42.41, 141.10], "恵庭市": [42.88, 141.58], "北広島市": [42.98, 141.56], "石狩市": [43.16, 141.30], "北斗市": [41.82, 140.65], "当別町": [43.22, 141.51], "新篠津村": [43.22, 141.65], "松前町": [41.43, 140.11], "福島町": [41.48, 140.25], "知内町": [41.59, 140.41], "木古内町": [41.61, 140.44], "七飯町": [41.89, 140.69], "鹿部町": [42.03, 140.83], "森町": [42.11, 140.57], "八雲町": [42.25, 140.27], "長万部町": [42.51, 140.37], "江差町": [41.87, 140.13], "上ノ国町": [41.80, 140.12], "厚沢部町": [41.96, 140.24], "乙部町": [41.97, 140.14], "奥尻町": [42.17, 139.51], "今金町": [42.43, 140.01], "せたな町": [42.45, 139.85], "島牧村": [42.70, 140.05], "寿都町": [42.79, 140.23], "黒松内町": [42.67, 140.30], "蘭越町": [42.80, 140.52], "ニセコ町": [42.80, 140.69], "真狩村": [42.76, 140.80], "留寿都村": [42.75, 140.90], "喜茂別町": [42.80, 141.05], "京極町": [42.86, 140.88], "倶知安町": [42.90, 140.75], "共和町": [42.98, 140.62], "岩内町": [42.98, 140.51], "泊村": [43.06, 140.50], "神恵内村": [43.14, 140.43], "積丹町": [43.29, 140.59], "古平町": [43.27, 140.64], "仁木町": [43.11, 140.78], "余市町": [43.18, 140.79], "赤井川村": [43.00, 140.82], "南幌町": [43.06, 141.65], "奈井江町": [43.42, 141.89], "上砂川町": [43.48, 141.98], "由仁町": [43.01, 141.79], "長沼町": [43.01, 141.69], "栗山町": [43.06, 141.77], "月形町": [43.34, 141.67], "浦臼町": [43.43, 141.81], "新十津川町": [43.56, 141.88], "妹背牛町": [43.69, 141.97], "秩父別町": [43.76, 141.95], "雨竜町": [43.63, 141.89], "北竜町": [43.73, 141.89], "沼田町": [43.81, 141.94], "鷹栖町": [43.83, 142.36], "東神楽町": [43.68, 142.45], "当麻町": [43.83, 142.52], "比布町": [43.87, 142.48], "愛別町": [43.90, 142.57], "上川町": [43.85, 142.77], "東川町": [43.71, 142.50], "美瑛町": [43.59, 142.46], "上富良野町": [43.46, 142.46], "中富良野町": [43.40, 142.42], "南富良野町": [43.16, 142.56], "占冠村": [42.99, 142.40], "和寒町": [44.02, 142.41], "剣淵町": [44.09, 142.37], "下川町": [44.30, 142.63], "美深町": [44.48, 142.35], "音威子府村": [44.73, 142.26], "中川町": [44.81, 142.07], "幌加内町": [44.01, 142.15], "増毛町": [43.85, 141.53], "小平町": [44.03, 141.66], "苫前町": [44.31, 141.65], "羽幌町": [44.36, 141.70], "初山別村": [44.55, 141.76], "遠別町": [44.72, 141.80], "天塩町": [44.88, 141.74], "猿払村": [45.33, 142.11], "浜頓別町": [45.12, 142.36], "中頓別町": [44.97, 142.29], "枝幸町": [44.94, 142.58], "豊富町": [45.10, 141.77], "礼文町": [45.30, 141.04], "利尻町": [45.18, 141.22], "利尻富士町": [45.24, 141.21], "幌延町": [45.01, 141.84], "美幌町": [43.83, 144.11], "津別町": [43.70, 144.03], "斜里町": [43.91, 144.66], "清里町": [43.84, 144.59], "小清水町": [43.85, 144.46], "訓子府町": [43.72, 143.74], "置戸町": [43.69, 143.59], "佐呂間町": [44.02, 143.77], "遠軽町": [44.06, 143.52], "湧別町": [44.17, 143.61], "滝上町": [44.19, 143.07], "興部町": [44.47, 143.12], "西興部村": [44.33, 142.93], "雄武町": [44.58, 142.96], "大空町": [43.91, 144.16], "音更町": [42.96, 143.20], "士幌町": [43.18, 143.26], "上士幌町": [43.23, 143.29], "鹿追町": [43.10, 142.99], "新得町": [43.08, 142.83], "清水町": [43.01, 142.88], "芽室町": [42.91, 143.05], "中札内村": [42.70, 143.13], "更別村": [42.65, 143.19], "大樹町": [42.50, 143.28], "広尾町": [42.29, 143.31], "幕別町": [42.91, 143.36], "池田町": [42.93, 143.45], "豊頃町": [42.79, 143.51], "本別町": [43.12, 143.61], "足寄町": [43.24, 143.55], "陸別町": [43.47, 143.74], "浦幌町": [42.81, 143.65], "釧路町": [43.01, 144.46], "厚岸町": [43.05, 144.85], "浜中町": [43.14, 145.12], "標茶町": [43.30, 144.60], "弟子屈町": [43.48, 144.46], "鶴居村": [43.23, 144.32], "白糠町": [42.96, 144.07], "別海町": [43.39, 145.12], "中標津町": [43.55, 144.97], "標津町": [43.66, 145.13], "羅臼町": [44.02, 145.19], "日高町": [42.48, 142.07], "平取町": [42.63, 142.14], "新冠町": [42.36, 142.32], "浦河町": [42.17, 142.77], "様似町": [42.13, 142.93], "えりも町": [42.02, 143.15], "新ひだか町": [42.34, 142.37],
            "青森市": [40.82, 140.74], "弘前市": [40.60, 140.46], "八戸市": [40.51, 141.48], "黒石市": [40.64, 140.59], "五所川原市": [40.80, 140.44], "十和田市": [40.61, 141.21], "三沢市": [40.68, 141.36], "むつ市": [41.29, 141.18], "つがる市": [40.80, 140.40], "平川市": [40.57, 140.56], "平内町": [40.93, 140.96], "今別町": [41.18, 140.48], "蓬田村": [40.97, 140.66], "外ヶ浜町": [41.04, 140.63], "鰺ヶ沢町": [40.77, 140.22], "深浦町": [40.65, 139.93], "西目屋村": [40.54, 140.27], "藤崎町": [40.65, 140.48], "大鰐町": [40.52, 140.57], "田舎館村": [40.63, 140.55], "板柳町": [40.70, 140.46], "鶴田町": [40.76, 140.43], "中泊町": [40.97, 140.43], "野辺地町": [40.87, 141.12], "七戸町": [40.70, 141.15], "六戸町": [40.62, 141.22], "横浜町": [41.02, 141.24], "東北町": [40.73, 141.26], "六ヶ所村": [40.97, 141.37], "おいらせ町": [40.60, 141.41], "大間町": [41.53, 140.91], "東通村": [41.25, 141.33], "風間浦村": [41.47, 141.06], "佐井村": [41.44, 140.85], "三戸町": [40.38, 141.26], "五戸町": [40.52, 141.30], "田子町": [40.34, 141.15], "南部町": [40.46, 141.37], "階上町": [40.46, 141.62], "新郷村": [40.46, 141.16],
            "盛岡市": [39.70, 141.15], "宮古市": [39.64, 141.95], "大船渡市": [39.08, 141.70], "花巻市": [39.39, 141.11], "北上市": [39.28, 141.11], "久慈市": [40.19, 141.77], "遠野市": [39.32, 141.53], "一関市": [38.93, 141.13], "陸前高田市": [39.01, 141.63], "釜石市": [39.27, 141.88], "二戸市": [40.27, 141.30], "八幡平市": [39.99, 141.08], "奥州市": [39.14, 141.14], "滝沢市": [39.73, 141.07], "雫石町": [39.70, 140.97], "葛巻町": [40.03, 141.44], "岩手町": [39.97, 141.28], "紫波町": [39.55, 141.16], "矢巾町": [39.61, 141.14], "西和賀町": [39.31, 140.78], "金ケ崎町": [39.19, 141.11], "平泉町": [39.00, 141.11], "住田町": [39.14, 141.57], "大槌町": [39.36, 141.90], "山田町": [39.47, 141.95], "岩泉町": [39.84, 141.79], "田野畑村": [39.93, 141.89], "普代村": [40.00, 141.88], "野田村": [40.11, 141.82], "九戸村": [40.16, 141.43], "洋野町": [40.29, 141.72], "一戸町": [40.21, 141.30],
            "仙台市": [38.26, 140.87], "石巻市": [38.43, 141.30], "塩竈市": [38.31, 141.02], "気仙沼市": [38.90, 141.57], "白石市": [38.00, 140.62], "名取市": [38.17, 140.89], "角田市": [37.97, 140.78], "多賀城市": [38.29, 141.00], "岩沼市": [38.10, 140.87], "登米市": [38.69, 141.18], "栗原市": [38.73, 141.01], "東松島市": [38.42, 141.21], "大崎市": [38.57, 140.95], "富谷市": [38.39, 140.89], "蔵王町": [38.07, 140.65], "七ヶ宿町": [38.00, 140.44], "大河原町": [38.05, 140.73], "村田町": [38.12, 140.72], "柴田町": [38.06, 140.77], "川崎町": [38.18, 140.64], "丸森町": [37.91, 140.77], "亘理町": [38.04, 140.86], "山元町": [37.96, 140.87], "松島町": [38.37, 141.07], "七ヶ浜町": [38.30, 141.05], "利府町": [38.33, 140.97], "大和町": [38.44, 140.88], "大郷町": [38.38, 141.00], "大衡村": [38.49, 140.87], "色麻町": [38.54, 140.82], "加美町": [38.57, 140.77], "涌谷町": [38.54, 141.13], "美里町": [38.54, 141.06], "女川町": [38.45, 141.44], "南三陸町": [38.67, 141.44],
            "秋田市": [39.72, 140.10], "能代市": [40.21, 140.02], "横手市": [39.31, 140.56], "大館市": [40.27, 140.55], "男鹿市": [39.88, 139.84], "湯沢市": [39.16, 140.49], "鹿角市": [40.18, 140.78], "由利本荘市": [39.38, 140.04], "潟上市": [39.85, 140.01], "大仙市": [39.45, 140.47], "北秋田市": [40.22, 140.37], "にかほ市": [39.29, 139.96], "仙北市": [39.70, 140.73], "小坂町": [40.33, 140.75], "上小阿仁村": [40.09, 140.39], "藤里町": [40.27, 140.27], "三種町": [40.12, 140.06], "八峰町": [40.35, 140.03], "五城目町": [39.94, 140.11], "八郎潟町": [39.95, 140.08], "井川町": [39.92, 140.07], "大潟村": [40.00, 140.00], "美郷町": [39.43, 140.58], "羽後町": [39.20, 140.41], "東成瀬村": [39.20, 140.67],
            "山形市": [38.25, 140.33], "米沢市": [37.92, 140.11], "鶴岡市": [38.72, 139.82], "酒田市": [38.92, 139.83], "新庄市": [38.76, 140.30], "寒河江市": [38.37, 140.27], "上山市": [38.15, 140.27], "村山市": [38.48, 140.38], "長井市": [38.10, 140.03], "天童市": [38.35, 140.37], "東根市": [38.43, 140.39], "尾花沢市": [38.60, 140.40], "南陽市": [38.05, 140.15],
            "福島市": [37.76, 140.47], "会津若松市": [37.49, 139.93], "郡山市": [37.39, 140.38], "いわき市": [37.05, 140.88], "白河市": [37.12, 140.21], "須賀川市": [37.28, 140.37], "喜多方市": [37.65, 139.87], "相馬市": [37.79, 140.92], "二本松市": [37.58, 140.43], "田村市": [37.44, 140.57], "南相馬市": [37.63, 140.96], "伊達市": [37.81, 140.56], "本宮市": [37.51, 140.39], "桑折町": [37.85, 140.52], "国見町": [37.87, 140.55], "川俣町": [37.66, 140.59], "大玉村": [37.54, 140.36], "鏡石町": [37.25, 140.35], "天栄村": [37.30, 140.23], "下郷町": [37.30, 139.90], "檜枝岐村": [37.03, 139.39], "只見町": [37.35, 139.31], "南会津町": [37.20, 139.77], "北塩原村": [37.65, 140.04], "西会津町": [37.59, 139.64], "磐梯町": [37.58, 139.97], "猪苗代町": [37.56, 140.10], "会津坂下町": [37.56, 139.82], "湯川村": [37.57, 139.90], "柳津町": [37.53, 139.72], "三島町": [37.47, 139.64], "金山町": [37.45, 139.52], "昭和村": [37.33, 139.61], "会津美里町": [37.46, 139.84], "西郷村": [37.16, 140.15], "泉崎村": [37.16, 140.31], "中島村": [37.16, 140.36], "矢吹町": [37.20, 140.33], "棚倉町": [37.03, 140.39], "矢祭町": [36.95, 140.42], "塙町": [36.98, 140.41], "鮫川村": [37.03, 140.53], "石川町": [37.14, 140.45], "玉川村": [37.22, 140.41], "平田村": [37.22, 140.57], "浅川町": [37.08, 140.41], "古殿町": [37.09, 140.55], "三春町": [37.44, 140.49], "小野町": [37.28, 140.63], "広野町": [37.22, 141.00], "楢葉町": [37.28, 141.00], "富岡町": [37.34, 141.00], "川内村": [37.34, 140.81], "大熊町": [37.41, 140.97], "双葉町": [37.45, 141.00], "浪江町": [37.49, 140.99], "葛尾村": [37.50, 140.76], "新地町": [37.88, 140.92], "飯舘村": [37.67, 140.73],
            "水戸市": [36.36, 140.47], "日立市": [36.59, 140.65], "土浦市": [36.07, 140.20], "古河市": [36.19, 139.71], "石岡市": [36.19, 140.28], "結城市": [36.29, 139.88], "龍ケ崎市": [35.91, 140.18], "下妻市": [36.18, 139.96], "常総市": [36.02, 139.99], "常陸太田市": [36.53, 140.52], "高萩市": [36.71, 140.71], "北茨城市": [36.80, 140.75], "笠間市": [36.38, 140.26], "取手市": [35.91, 140.05], "牛久市": [35.97, 140.15], "つくば市": [36.08, 140.11], "ひたちなか市": [36.39, 140.53], "鹿嶋市": [35.96, 140.64], "潮来市": [35.93, 140.54], "守谷市": [35.95, 139.99], "常陸大宮市": [36.55, 140.40], "那珂市": [36.46, 140.48], "筑西市": [36.30, 139.98], "坂東市": [36.05, 139.88], "稲敷市": [35.95, 140.32], "かすみがうら市": [36.15, 140.24], "桜川市": [36.36, 140.09], "神栖市": [35.90, 140.66], "行方市": [36.00, 140.49], "鉾田市": [36.16, 140.51], "つくばみらい市": [35.96, 140.04], "小美玉市": [36.22, 140.30], "茨城町": [36.28, 140.42], "大洗町": [36.31, 140.57], "城里町": [36.48, 140.29], "東海村": [36.46, 140.56], "大子町": [36.76, 140.35], "美浦村": [36.00, 140.30], "阿見町": [36.03, 140.21], "河内町": [35.89, 140.27], "八千代町": [36.18, 139.89], "五霞町": [36.11, 139.75], "境町": [36.10, 139.82], "利根町": [35.86, 140.14],
            "宇都宮市": [36.55, 139.88], "足利市": [36.33, 139.45], "栃木市": [36.38, 139.73], "佐野市": [36.31, 139.57], "鹿沼市": [36.56, 139.74], "日光市": [36.71, 139.69], "小山市": [36.31, 139.80], "真岡市": [36.44, 140.01], "大田原市": [36.87, 140.02], "矢板市": [36.80, 139.92], "那須塩原市": [36.96, 140.04], "さくら市": [36.68, 139.96], "那須烏山市": [36.65, 140.15], "下野市": [36.39, 139.85], "上三川町": [36.43, 139.91], "益子町": [36.46, 140.10], "茂木町": [36.53, 140.19], "市貝町": [36.54, 140.09], "芳賀町": [36.55, 140.05], "壬生町": [36.42, 139.80], "野木町": [36.23, 139.73], "塩谷町": [36.76, 139.85], "高根沢町": [36.63, 139.98], "那須町": [37.03, 140.12], "那珂川町": [36.73, 140.16],
            "前橋市": [36.38, 139.06], "高崎市": [36.32, 139.00], "桐生市": [36.41, 139.33], "伊勢崎市": [36.32, 139.19], "太田市": [36.29, 139.37], "沼田市": [36.64, 139.04], "館林市": [36.24, 139.54], "渋川市": [36.49, 138.99], "藤岡市": [36.25, 139.07], "富岡市": [36.26, 138.89], "安中市": [36.33, 138.90], "みどり市": [36.43, 139.28], "榛東村": [36.43, 138.97], "吉岡町": [36.44, 139.01], "上野村": [36.06, 138.68], "神流町": [36.12, 138.91], "下仁田町": [36.21, 138.78], "南牧村": [36.12, 138.71], "甘楽町": [36.23, 138.98], "中之条町": [36.58, 138.84], "長野原町": [36.54, 138.64], "嬬恋村": [36.52, 138.53], "草津町": [36.62, 138.59], "高山村": [36.63, 138.95], "東吾妻町": [36.57, 138.82], "片品村": [36.81, 139.23], "川場村": [36.70, 139.10], "昭和村": [36.62, 139.06], "みなかみ町": [36.67, 138.99], "玉村町": [36.29, 139.11], "板倉町": [36.22, 139.61], "明和町": [36.21, 139.56], "千代田町": [36.21, 139.46], "大泉町": [36.25, 139.40], "邑楽町": [36.26, 139.47],
            "さいたま市": [35.86, 139.64], "川越市": [35.92, 139.48], "熊谷市": [36.14, 139.38], "川口市": [35.80, 139.71], "行田市": [36.14, 139.45], "秩父市": [35.99, 139.08], "所沢市": [35.79, 139.46], "飯能市": [35.85, 139.32], "加須市": [36.13, 139.59], "本庄市": [36.24, 139.19], "東松山市": [36.04, 139.40], "春日部市": [35.97, 139.75], "狭山市": [35.85, 139.41], "羽生市": [36.17, 139.54], "鴻巣市": [36.05, 139.51], "深谷市": [36.19, 139.28], "上尾市": [35.97, 139.58], "草加市": [35.83, 139.80], "越谷市": [35.89, 139.79], "蕨市": [35.82, 139.68], "戸田市": [35.81, 139.67], "入間市": [35.83, 139.39], "朝霞市": [35.80, 139.60], "志木市": [35.83, 139.57], "和光市": [35.78, 139.61], "新座市": [35.79, 139.56], "桶川市": [36.00, 139.56], "久喜市": [36.06, 139.67], "北本市": [36.03, 139.53], "八潮市": [35.82, 139.84], "富士見市": [35.85, 139.54], "三郷市": [35.84, 139.87], "蓮田市": [36.00, 139.66], "坂戸市": [35.95, 139.40], "幸手市": [36.07, 139.72], "鶴ヶ島市": [35.93, 139.39], "日高市": [35.90, 139.33], "吉川市": [35.87, 139.84], "ふじみ野市": [35.87, 139.52], "白岡市": [36.01, 139.66], "伊奈町": [36.01, 139.62], "三芳町": [35.83, 139.52], "毛呂山町": [35.94, 139.30], "越生町": [35.96, 139.29], "滑川町": [36.07, 139.35], "嵐山町": [36.05, 139.31], "小川町": [36.05, 139.26], "川島町": [35.98, 139.48], "吉見町": [36.03, 139.45], "鳩山町": [35.98, 139.33], "ときがわ町": [35.99, 139.29], "宮代町": [36.02, 139.72], "杉戸町": [36.03, 139.73], "松伏町": [35.92, 139.81],
            "千葉市": [35.60, 140.12], "銚子市": [35.73, 140.82], "市川市": [35.72, 139.92], "船橋市": [35.70, 139.98], "館山市": [34.99, 139.87], "木更津市": [35.38, 139.92], "松戸市": [35.79, 139.90], "野田市": [35.95, 139.87], "茂原市": [35.42, 140.29], "成田市": [35.77, 140.31], "佐倉市": [35.72, 140.23], "東金市": [35.56, 140.36], "旭市": [35.72, 140.64], "習志野市": [35.68, 140.02], "柏市": [35.86, 139.97], "勝浦市": [35.15, 140.32], "市原市": [35.48, 140.12], "流山市": [35.85, 139.90], "八千代市": [35.72, 140.10], "我孫子市": [35.86, 140.02], "鴨川市": [35.11, 140.10], "鎌ケ谷市": [35.77, 140.00], "君津市": [35.32, 139.91], "富津市": [35.30, 139.85], "浦安市": [35.65, 139.90], "四街道市": [35.66, 140.16], "袖ケ浦市": [35.43, 140.00], "八街市": [35.66, 140.31], "印西市": [35.83, 140.14], "白井市": [35.79, 140.05], "富里市": [35.71, 140.34], "南房総市": [35.03, 139.96], "匝瑳市": [35.70, 140.56], "香取市": [35.89, 140.49], "山武市": [35.60, 140.42], "いすみ市": [35.25, 140.38], "大網白里市": [35.52, 140.33], "酒々井町": [35.72, 140.27], "栄町": [35.82, 140.21], "神崎町": [35.90, 140.40], "多古町": [35.73, 140.46], "東庄町": [35.82, 140.67], "九十九里町": [35.54, 140.45], "芝山町": [35.70, 140.40], "横芝光町": [35.65, 140.50], "一宮町": [35.37, 140.36], "睦沢町": [35.35, 140.32], "長生村": [35.43, 140.36], "白子町": [35.45, 140.40], "長柄町": [35.45, 140.23], "長南町": [35.39, 140.23], "大多喜町": [35.28, 140.24], "御宿町": [35.18, 140.35], "鋸南町": [35.13, 139.83],
            "東京": [35.68, 139.76], "千代田区": [35.69, 139.75], "中央区": [35.67, 139.77], "港区": [35.65, 139.75], "新宿区": [35.69, 139.70], "文京区": [35.70, 139.75], "台東区": [35.71, 139.77], "墨田区": [35.71, 139.81], "江東区": [35.64, 139.81], "品川区": [35.60, 139.73], "目黒区": [35.64, 139.69], "大田区": [35.57, 139.71], "世田谷区": [35.64, 139.65], "渋谷区": [35.66, 139.70], "中野区": [35.70, 139.66], "杉並区": [35.69, 139.63], "豊島区": [35.72, 139.71], "北区": [35.75, 139.73], "荒川区": [35.73, 139.78], "板橋区": [35.75, 139.70], "練馬区": [35.73, 139.65], "足立区": [35.77, 139.80], "葛飾区": [35.74, 139.84], "江戸川区": [35.70, 139.87], "八王子市": [35.65, 139.33], "立川市": [35.69, 139.41], "武蔵野市": [35.71, 139.56], "三鷹市": [35.68, 139.56], "青梅市": [35.78, 139.27], "府中市": [35.67, 139.47], "昭島市": [35.70, 139.36], "調布市": [35.65, 139.54], "町田市": [35.54, 139.44], "小金井市": [35.70, 139.50], "小平市": [35.73, 139.47], "日野市": [35.66, 139.39], "東村山市": [35.76, 139.46], "国分寺市": [35.71, 139.47], "国立市": [35.68, 139.44], "福生市": [35.74, 139.32], "狛江市": [35.63, 139.57], "東大和市": [35.74, 139.42], "清瀬市": [35.78, 139.52], "東久留米市": [35.75, 139.52], "武蔵村山市": [35.75, 139.38], "多摩市": [35.63, 139.44], "稲城市": [35.64, 139.50], "羽村市": [35.76, 139.31], "あきる野市": [35.72, 139.29], "西東京市": [35.73, 139.54], "瑞穂町": [35.77, 139.35], "日の出町": [35.74, 139.25], "檜原村": [35.72, 139.14], "奥多摩町": [35.80, 139.09], "大島町": [34.75, 139.35], "利島村": [34.52, 139.28], "新島村": [34.37, 139.26], "神津島村": [34.20, 139.15], "三宅村": [34.08, 139.52], "御蔵島村": [33.88, 139.60], "八丈町": [33.11, 139.79], "青ヶ島村": [32.46, 139.76], "小笠原村": [27.09, 142.19],
            "横浜市": [35.44, 139.63], "川崎市": [35.53, 139.70], "相模原市": [35.57, 139.37], "横須賀市": [35.28, 139.67], "平塚市": [35.33, 139.34], "鎌倉市": [35.31, 139.55], "藤沢市": [35.33, 139.48], "小田原市": [35.26, 139.15], "茅ヶ崎市": [35.33, 139.40], "逗子市": [35.29, 139.57], "三浦市": [35.14, 139.61], "秦野市": [35.37, 139.22], "厚木市": [35.44, 139.36], "大和市": [35.47, 139.46], "伊勢原市": [35.39, 139.31], "海老名市": [35.45, 139.39], "座間市": [35.48, 139.40], "南足柄市": [35.31, 139.10], "綾瀬市": [35.43, 139.43], "葉山町": [35.27, 139.58], "寒川町": [35.37, 139.38], "大磯町": [35.30, 139.31], "二宮町": [35.29, 139.26], "中井町": [35.33, 139.22], "大井町": [35.33, 139.16], "松田町": [35.34, 139.14], "山北町": [35.36, 139.08], "開成町": [35.32, 139.12], "箱根町": [35.23, 139.10], "真鶴町": [35.15, 139.13], "湯河原町": [35.14, 139.10], "愛川町": [35.54, 139.34], "清川村": [35.48, 139.23],
            "新潟市": [37.91, 139.02], "長岡市": [37.44, 138.85], "三条市": [37.63, 138.96], "柏崎市": [37.37, 138.55], "新発田市": [37.94, 139.32], "小千谷市": [37.31, 138.79], "加茂市": [37.66, 139.04], "十日町市": [37.13, 138.75], "見附市": [37.52, 138.91], "村上市": [38.22, 139.47], "燕市": [37.66, 138.92], "糸魚川市": [37.04, 137.86], "妙高市": [37.02, 138.25], "五泉市": [37.74, 139.17], "上越市": [37.14, 138.23], "阿賀野市": [37.83, 139.22], "佐渡市": [38.03, 138.40], "魚沼市": [37.22, 138.96], "南魚沼市": [37.06, 138.87], "胎内市": [38.06, 139.40],
            "富山市": [36.69, 137.21], "高岡市": [36.75, 137.01], "魚津市": [36.83, 137.40], "氷見市": [36.85, 136.98], "滑川市": [36.76, 137.33], "黒部市": [36.87, 137.44], "砺波市": [36.63, 136.96], "小矢部市": [36.67, 136.86], "南砺市": [36.56, 136.91], "射水市": [36.73, 137.08],
            "金沢市": [36.56, 136.65], "七尾市": [37.04, 136.96], "小松市": [36.40, 136.45], "輪島市": [37.39, 136.90], "珠洲市": [37.43, 137.26], "加賀市": [36.30, 136.34], "羽咋市": [36.89, 136.78], "かほく市": [36.72, 136.70], "白山市": [36.51, 136.57], "能美市": [36.44, 136.50], "野々市市": [36.53, 136.61], "能登町": [37.30, 137.15],
            "福井市": [36.06, 136.22], "敦賀市": [35.64, 136.06], "小浜市": [35.49, 135.74], "大野市": [35.98, 136.48], "勝山市": [36.06, 136.50], "鯖江市": [35.95, 136.18], "あわら市": [36.21, 136.22], "越前市": [35.90, 136.16], "坂井市": [36.16, 136.23],
            "甲府市": [35.66, 138.56], "富士吉田市": [35.48, 138.80], "都留市": [35.55, 138.90], "山梨市": [35.68, 138.68], "大月市": [35.61, 138.94], "韮崎市": [35.71, 138.45], "南アルプス市": [35.62, 138.46], "北杜市": [35.79, 138.41], "甲斐市": [35.67, 138.51], "笛吹市": [35.64, 138.63], "上野原市": [35.62, 139.11], "甲州市": [35.70, 138.72], "中央市": [35.60, 138.52], "山中湖村": [35.41, 138.87], "富士河口湖町": [35.50, 138.76],
            "長野市": [36.64, 138.18], "松本市": [36.23, 137.97], "上田市": [36.40, 138.25], "岡谷市": [36.06, 138.04], "飯田市": [35.51, 137.82], "諏訪市": [36.04, 138.11], "須坂市": [36.65, 138.30], "小諸市": [36.32, 138.42], "伊那市": [35.84, 137.96], "駒ヶ根市": [35.73, 137.93], "中野市": [36.74, 138.37], "大町市": [36.50, 137.85], "飯山市": [36.85, 138.36], "茅野市": [35.99, 138.15], "塩尻市": [36.11, 137.95], "佐久市": [36.24, 138.47], "千曲市": [36.53, 138.12], "東御市": [36.35, 138.39], "安曇野市": [36.30, 137.90], "小海町": [36.08, 138.48], "川上村": [35.97, 138.58], "南牧村": [35.98, 138.48], "南相木村": [36.01, 138.53], "北相木村": [36.05, 138.53], "佐久穂町": [36.16, 138.47], "軽井沢町": [36.34, 138.63], "御代田町": [36.32, 138.50], "立科町": [36.29, 138.31], "青木村": [36.37, 138.12], "長和町": [36.23, 138.23], "下諏訪町": [36.07, 138.09], "富士見町": [35.91, 138.24], "原村": [35.97, 138.22], "辰野町": [35.98, 137.99], "箕輪町": [35.92, 137.98], "南箕輪村": [35.86, 137.96], "中川村": [35.63, 137.93], "宮田村": [35.77, 137.94], "松川町": [35.59, 137.91], "高森町": [35.56, 137.88], "阿南町": [35.33, 137.82], "阿智村": [35.44, 137.76], "平谷村": [35.31, 137.65], "根羽村": [35.26, 137.58], "下條村": [35.42, 137.84], "売木村": [35.29, 137.72], "天龍村": [35.23, 137.82], "泰阜村": [35.40, 137.84], "喬木村": [35.51, 137.87], "豊丘村": [35.53, 137.88], "大鹿村": [35.57, 138.03], "上松町": [35.78, 137.69], "南木曽町": [35.60, 137.61], "木祖村": [35.92, 137.78], "王滝村": [35.82, 137.54], "大桑村": [35.67, 137.64], "木曽町": [35.84, 137.70], "麻績村": [36.42, 138.02], "生坂村": [36.42, 137.92], "山形村": [36.18, 137.85], "朝日村": [36.13, 137.83], "筑北村": [36.41, 138.02], "池田町": [36.43, 137.87], "松川村": [36.42, 137.82], "白馬村": [36.70, 137.86], "小谷村": [36.78, 137.91], "坂城町": [36.46, 138.15], "小布施町": [36.69, 138.31], "高山村": [36.68, 138.36], "山ノ内町": [36.74, 138.41], "木島平村": [36.85, 138.38], "野沢温泉村": [36.92, 138.44], "信濃町": [36.80, 138.20], "小川村": [36.61, 137.96], "飯綱町": [36.75, 138.21], "栄村": [36.98, 138.58],
            "岐阜市": [35.42, 136.75], "大垣市": [35.36, 136.61], "高山市": [36.14, 137.25], "多治見市": [35.33, 137.12], "関市": [35.48, 136.91], "中津川市": [35.48, 137.50], "美濃市": [35.54, 136.90], "瑞浪市": [35.35, 137.25], "羽島市": [35.32, 136.70], "恵那市": [35.45, 137.40], "美濃加茂市": [35.44, 137.01], "土岐市": [35.35, 137.18], "各務原市": [35.40, 136.83], "可児市": [35.42, 137.05], "山県市": [35.50, 136.78], "瑞穂市": [35.39, 136.66], "飛騨市": [36.23, 137.18], "本巣市": [35.50, 136.67], "郡上市": [35.74, 136.96], "下呂市": [35.80, 137.24], "海津市": [35.22, 136.63],
            "静岡市": [34.97, 138.38], "浜松市": [34.71, 137.72], "沼津市": [35.10, 138.86], "熱海市": [35.09, 139.07], "三島市": [35.11, 138.91], "富士宮市": [35.22, 138.61], "伊東市": [34.96, 139.09], "島田市": [34.83, 138.17], "富士市": [35.16, 138.67], "磐田市": [34.71, 137.85], "焼津市": [34.86, 138.31], "掛川市": [34.77, 138.01], "藤枝市": [34.86, 138.25], "御殿場市": [35.30, 138.93], "袋井市": [34.75, 137.92], "下田市": [34.67, 138.94], "裾野市": [35.17, 138.91], "湖西市": [34.72, 137.53], "伊豆市": [34.97, 138.94], "御前崎市": [34.63, 138.12], "菊川市": [34.76, 138.08], "伊豆の国市": [35.05, 138.94], "牧之原市": [34.75, 138.21], "東伊豆町": [34.79, 139.07], "河津町": [34.75, 138.98], "南伊豆町": [34.65, 138.86], "松崎町": [34.70, 138.78], "西伊豆町": [34.78, 138.78], "函南町": [35.08, 138.96], "清水町": [35.09, 138.90], "長泉町": [35.14, 138.89], "小山町": [35.35, 138.99], "吉田町": [34.77, 138.25], "川根本町": [35.08, 138.13], "森町": [34.83, 137.93],
            "名古屋市": [35.18, 136.90], "豊橋市": [34.76, 137.39], "岡崎市": [34.95, 137.17], "一宮市": [35.30, 136.80], "瀬戸市": [35.22, 137.08], "半田市": [34.89, 136.93], "春日井市": [35.25, 136.97], "豊川市": [34.82, 137.37], "津島市": [35.17, 136.73], "碧南市": [34.88, 136.99], "刈谷市": [34.99, 137.00], "豊田市": [35.08, 137.15], "安城市": [34.96, 137.06], "西尾市": [34.86, 137.05], "蒲郡市": [34.82, 137.22], "犬山市": [35.37, 136.93], "常滑市": [34.88, 136.83], "江南市": [35.33, 136.87], "小牧市": [35.29, 136.92], "稲沢市": [35.25, 136.78], "新城市": [34.90, 137.49], "東海市": [35.02, 136.90], "大府市": [35.01, 136.96], "知多市": [34.99, 136.86], "知立市": [35.00, 137.04], "尾張旭市": [35.21, 137.03], "高浜市": [34.93, 136.99], "岩倉市": [35.27, 136.87], "豊明市": [35.05, 137.01], "日進市": [35.13, 137.04], "田原市": [34.66, 137.27], "愛西市": [35.15, 136.72], "清須市": [35.21, 136.85], "北名古屋市": [35.24, 136.87], "弥富市": [35.11, 136.72], "みよし市": [35.08, 137.07], "あま市": [35.19, 136.78], "長久手市": [35.17, 137.04],
            "津市": [34.71, 136.50], "四日市市": [34.96, 136.62], "伊勢市": [34.49, 136.70], "松阪市": [34.57, 136.53], "桑名市": [35.06, 136.68], "鈴鹿市": [34.88, 136.58], "名張市": [34.62, 136.09], "尾鷲市": [34.07, 136.18], "亀山市": [34.85, 136.45], "鳥羽市": [34.48, 136.84], "熊野市": [33.89, 136.09], "いなべ市": [35.15, 136.51], "志摩市": [34.32, 136.82], "伊賀市": [34.76, 136.13], "東員町": [35.08, 136.58], "菰野町": [35.01, 136.51], "朝日町": [35.03, 136.66], "川越町": [35.02, 136.67], "多気町": [34.50, 136.56], "明和町": [34.54, 136.63], "大台町": [34.39, 136.40], "玉城町": [34.48, 136.63], "度会町": [34.42, 136.64], "大紀町": [34.35, 136.43], "南伊勢町": [34.27, 136.62], "紀北町": [34.12, 136.25], "御浜町": [33.81, 136.03], "紀宝町": [33.73, 136.00],
            "大津市": [35.01, 135.85], "彦根市": [35.27, 136.26], "長浜市": [35.37, 136.26], "近江八幡市": [35.13, 136.10], "草津市": [35.01, 135.96], "守山市": [35.05, 135.99], "栗東市": [35.02, 136.00], "甲賀市": [34.96, 136.16], "野洲市": [35.07, 136.02], "湖南市": [35.00, 136.08], "高島市": [35.33, 136.03], "東近江市": [35.11, 136.21], "米原市": [35.32, 136.28],
            "京都市": [35.01, 135.76], "福知山市": [35.29, 135.12], "舞鶴市": [35.47, 135.39], "綾部市": [35.30, 135.26], "宇治市": [34.89, 135.80], "宮津市": [35.53, 135.19], "亀岡市": [35.01, 135.58], "城陽市": [34.85, 135.78], "向日市": [34.94, 135.70], "長岡京市": [34.92, 135.70], "八幡市": [34.87, 135.70], "京田辺市": [34.81, 135.77], "京丹後市": [35.62, 135.06], "南丹市": [35.10, 135.47], "木津川市": [34.73, 135.82],
            "大阪市": [34.69, 135.50], "堺市": [34.57, 135.48], "岸和田市": [34.46, 135.37], "豊中市": [34.78, 135.46], "池田市": [34.82, 135.43], "吹田市": [34.75, 135.51], "泉大津市": [34.50, 135.41], "高槻市": [34.84, 135.61], "貝塚市": [34.44, 135.35], "守口市": [34.73, 135.56], "枚方市": [34.81, 135.65], "茨木市": [34.81, 135.56], "八尾市": [34.62, 135.60], "泉佐野市": [34.40, 135.31], "富田林市": [34.50, 135.59], "寝屋川市": [34.76, 135.62], "河内長野市": [34.45, 135.56], "松原市": [34.57, 135.55], "大東市": [34.71, 135.62], "和泉市": [34.48, 135.42], "箕面市": [34.82, 135.47], "柏原市": [34.58, 135.62], "羽曳野市": [34.55, 135.60], "門真市": [34.73, 135.59], "摂津市": [34.77, 135.56], "高石市": [34.52, 135.43], "藤井寺市": [34.57, 135.59], "東大阪市": [34.66, 135.59], "泉南市": [34.37, 135.28], "四條畷市": [34.72, 135.64], "交野市": [34.78, 135.68], "大阪狭山市": [34.50, 135.55], "阪南市": [34.35, 135.24], "忠岡町": [34.49, 135.39], "熊取町": [34.40, 135.35], "田尻町": [34.39, 135.29], "岬町": [34.31, 135.15], "太子町": [34.52, 135.64], "河南町": [34.48, 135.63], "千早赤阪村": [34.46, 135.62], "能勢町": [34.96, 135.40], "豊能町": [34.90, 135.47], "島本町": [34.88, 135.66],
            "神戸市": [34.69, 135.19], "姫路市": [34.81, 134.69], "尼崎市": [34.71, 135.41], "明石市": [34.64, 134.99], "西宮市": [34.73, 135.34], "洲本市": [34.34, 134.89], "芦屋市": [34.73, 135.30], "伊丹市": [34.78, 135.41], "相生市": [34.81, 134.46], "豊岡市": [35.54, 134.82], "加古川市": [34.76, 134.83], "赤穂市": [34.75, 134.39], "西脇市": [34.97, 134.97], "宝塚市": [34.80, 135.35], "三木市": [34.80, 135.00], "高砂市": [34.76, 134.79], "川西市": [34.82, 135.41], "小野市": [34.85, 134.93], "三田市": [34.88, 135.22], "加西市": [34.93, 134.84], "丹波篠山市": [35.07, 135.21], "養父市": [35.31, 134.76], "丹波市": [35.17, 135.03], "南あわじ市": [34.30, 134.77], "朝来市": [35.29, 134.83], "淡路市": [34.43, 134.90], "宍粟市": [35.00, 134.54], "加東市": [34.91, 134.99], "たつの市": [34.86, 134.54], "猪名川町": [34.90, 135.38], "多可町": [35.05, 134.91], "稲美町": [34.73, 134.91], "播磨町": [34.71, 134.87], "市川町": [34.98, 134.76], "福崎町": [34.95, 134.75], "神河町": [35.06, 134.73], "太子町": [34.83, 134.58], "上郡町": [34.86, 134.35], "佐用町": [35.00, 134.35], "香美町": [35.63, 134.62], "新温泉町": [35.56, 134.45],
            "奈良市": [34.68, 135.80], "大和高田市": [34.51, 135.73], "大和郡山市": [34.64, 135.78], "天理市": [34.60, 135.83], "橿原市": [34.50, 135.79], "桜井市": [34.51, 135.84], "五條市": [34.35, 135.70], "御所市": [34.46, 135.73], "生駒市": [34.69, 135.70], "香芝市": [34.54, 135.70], "葛城市": [34.49, 135.72], "宇陀市": [34.53, 135.95], "山添村": [34.65, 136.04], "平群町": [34.64, 135.70], "三郷町": [34.60, 135.70], "斑鳩町": [34.61, 135.73], "安堵町": [34.61, 135.75], "川西町": [34.58, 135.77], "三宅町": [34.57, 135.78], "田原本町": [34.55, 135.79], "曽爾村": [34.52, 136.10], "御杖村": [34.49, 136.17], "高取町": [34.44, 135.79], "明日香村": [34.47, 135.81], "上牧町": [34.56, 135.71], "王寺町": [34.59, 135.70], "広陵町": [34.55, 135.73], "河合町": [34.58, 135.73], "吉野町": [34.39, 135.86], "大淀町": [34.38, 135.78], "下市町": [34.35, 135.79], "黒滝村": [34.30, 135.83], "天川村": [34.21, 135.87], "野迫川村": [34.14, 135.63], "十津川村": [33.99, 135.79], "下北山村": [34.03, 135.95], "上北山村": [34.13, 135.98], "川上村": [34.33, 135.94], "東吉野村": [34.40, 135.99],
            "和歌山市": [34.23, 135.17], "海南市": [34.15, 135.21], "橋本市": [34.31, 135.61], "有田市": [34.08, 135.13], "御坊市": [33.89, 135.15], "田辺市": [33.72, 135.37], "新宮市": [33.72, 135.99], "紀の川市": [34.27, 135.36], "岩出市": [34.26, 135.30], "紀美野町": [34.15, 135.31], "かつらぎ町": [34.30, 135.51], "九度山町": [34.29, 135.56], "高野町": [34.21, 135.58], "湯浅町": [34.03, 135.18], "広川町": [34.01, 135.18], "有田川町": [34.06, 135.26], "美浜町": [33.88, 135.12], "日高町": [33.91, 135.13], "由良町": [33.95, 135.11], "印南町": [33.82, 135.21], "みなべ町": [33.76, 135.32], "日高川町": [33.91, 135.21], "白浜町": [33.67, 135.35], "上富田町": [33.72, 135.43], "すさみ町": [33.55, 135.49], "那智勝浦町": [33.62, 135.93], "太地町": [33.59, 135.94], "古座川町": [33.53, 135.81], "北山村": [33.94, 135.97], "串本町": [33.47, 135.78],
            "鳥取市": [35.50, 134.23], "米子市": [35.42, 133.33], "倉吉市": [35.43, 133.82], "境港市": [35.54, 133.23],
            "松江市": [35.46, 133.04], "浜田市": [34.89, 132.08], "出雲市": [35.36, 132.75], "益田市": [34.67, 131.84], "大田市": [35.19, 132.49], "安来市": [35.43, 133.25], "江津市": [35.01, 132.21], "雲南市": [35.29, 132.90],
            "岡山市": [34.65, 133.91], "倉敷市": [34.58, 133.77], "津山市": [35.07, 134.00], "玉野市": [34.49, 133.94], "笠岡市": [34.50, 133.50], "井原市": [34.59, 133.46], "総社市": [34.67, 133.73], "高梁市": [34.79, 133.61], "新見市": [34.97, 133.47], "備前市": [34.74, 134.18], "瀬戸内市": [34.66, 134.09], "赤磐市": [34.77, 134.01], "真庭市": [35.08, 133.75], "美作市": [35.00, 134.14], "浅口市": [34.52, 133.58],
            "広島市": [34.38, 132.45], "呉市": [34.24, 132.56], "竹原市": [34.34, 132.91], "三原市": [34.39, 133.08], "尾道市": [34.40, 133.19], "福山市": [34.48, 133.36], "府中市": [34.57, 133.23], "三次市": [34.80, 132.85], "庄原市": [34.86, 133.01], "大竹市": [34.21, 132.22], "東広島市": [34.42, 132.74], "廿日市市": [34.35, 132.33], "安芸高田市": [34.66, 132.70], "江田島市": [34.22, 132.47], "府中町": [34.39, 132.50], "海田町": [34.37, 132.53], "熊野町": [34.34, 132.57], "坂町": [34.34, 132.51], "安芸太田町": [34.56, 132.24], "北広島町": [34.68, 132.52], "大崎上島町": [34.23, 132.88], "世羅町": [34.62, 133.06], "神石高原町": [34.76, 133.22],
            "下関市": [33.95, 130.94], "宇部市": [33.94, 131.24], "山口市": [34.17, 131.47], "萩市": [34.41, 131.40], "防府市": [34.05, 131.56], "下松市": [34.01, 131.87], "岩国市": [34.16, 132.22], "光市": [33.96, 131.94], "長門市": [34.37, 131.18], "柳井市": [33.96, 132.10], "美祢市": [34.16, 131.20], "周南市": [34.05, 131.80], "山陽小野田市": [34.03, 131.17],
            "徳島市": [34.07, 134.55], "鳴門市": [34.17, 134.61], "小松島市": [34.00, 134.58], "阿南市": [33.92, 134.66], "吉野川市": [34.07, 134.35], "阿波市": [34.09, 134.25], "美馬市": [34.05, 134.17], "三好市": [34.03, 133.80],
            "高松市": [34.34, 134.04], "丸亀市": [34.29, 133.79], "坂出市": [34.31, 133.86], "善通寺市": [34.22, 133.78], "観音寺市": [34.12, 133.65], "さぬき市": [34.26, 134.17], "東かがわ市": [34.24, 134.36], "三豊市": [34.16, 133.70], "土庄町": [34.48, 134.17], "小豆島町": [34.47, 134.29], "三木町": [34.27, 134.13], "直島町": [34.46, 133.99], "宇多津町": [34.31, 133.82], "綾川町": [34.23, 133.91], "琴平町": [34.19, 133.82], "多度津町": [34.27, 133.75], "まんのう町": [34.16, 133.86],
            "松山市": [33.83, 132.76], "今治市": [34.06, 132.99], "宇和島市": [33.22, 132.56], "八幡浜市": [33.46, 132.42], "新居浜市": [33.96, 133.28], "西条市": [33.91, 133.18], "大洲市": [33.50, 132.54], "伊予市": [33.75, 132.70], "四国中央市": [33.98, 133.54], "西予市": [33.36, 132.50], "東温市": [33.79, 132.87],
            "高知市": [33.55, 133.53], "室戸市": [33.29, 134.15], "安芸市": [33.50, 133.90], "南国市": [33.59, 133.64], "土佐市": [33.49, 133.42], "須崎市": [33.41, 133.29], "宿毛市": [32.94, 132.72], "土佐清水市": [32.78, 132.95], "四万十市": [32.99, 132.93], "香南市": [33.56, 133.70], "香美市": [33.61, 133.68],
            "北九州市": [33.88, 130.87], "福岡市": [33.60, 130.41], "大牟田市": [33.02, 130.44], "久留米市": [33.31, 130.51], "直方市": [33.74, 130.72], "飯塚市": [33.64, 130.69], "田川市": [33.63, 130.80], "柳川市": [33.16, 130.42], "八女市": [33.21, 130.55], "筑後市": [33.21, 130.50], "大川市": [33.20, 130.38], "行橋市": [33.71, 130.97], "豊前市": [33.61, 131.12], "中間市": [33.81, 130.71], "小郡市": [33.39, 130.55], "筑紫野市": [33.49, 130.51], "春日市": [33.53, 130.47], "大野城市": [33.53, 130.47], "宗像市": [33.80, 130.54], "太宰府市": [33.51, 130.52], "古賀市": [33.73, 130.47], "福津市": [33.76, 130.48], "うきは市": [33.34, 130.76], "宮若市": [33.72, 130.66], "嘉麻市": [33.55, 130.72], "朝倉市": [33.41, 130.65], "みやま市": [33.15, 130.47], "糸島市": [33.55, 130.19], "那珂川市": [33.50, 130.42],
            "佐賀市": [33.26, 130.30], "唐津市": [33.44, 129.96], "鳥栖市": [33.37, 130.51], "多久市": [33.28, 130.11], "伊万里市": [33.26, 129.87], "武雄市": [33.19, 130.02], "鹿島市": [33.10, 130.09], "小城市": [33.28, 130.20], "嬉野市": [33.12, 129.97], "神埼市": [33.30, 130.37],
            "長崎市": [32.75, 129.87], "佐世保市": [33.17, 129.72], "島原市": [32.78, 130.37], "諫早市": [32.84, 130.05], "大村市": [32.90, 129.96], "平戸市": [33.36, 129.55], "松浦市": [33.34, 129.71], "対馬市": [34.20, 129.29], "壱岐市": [33.75, 129.69], "五島市": [32.69, 128.84], "西海市": [33.00, 129.66], "雲仙市": [32.83, 130.29], "南島原市": [32.65, 130.27],
            "熊本市": [32.80, 130.70], "八代市": [32.50, 130.60], "人吉市": [32.21, 130.76], "荒尾市": [32.99, 130.43], "水俣市": [32.21, 130.40], "玉名市": [32.93, 130.55], "山鹿市": [33.01, 130.69], "菊池市": [32.98, 130.81], "宇土市": [32.68, 130.66], "上天草市": [32.58, 130.43], "宇城市": [32.65, 130.68], "阿蘇市": [32.93, 131.11], "天草市": [32.46, 130.19], "合志市": [32.88, 130.78],
            "大分市": [33.23, 131.60], "別府市": [33.28, 131.49], "中津市": [33.59, 131.19], "日田市": [33.32, 130.94], "佐伯市": [32.96, 131.89], "臼杵市": [33.12, 131.80], "津久見市": [33.07, 131.86], "竹田市": [32.96, 131.39], "豊后高田市": [33.56, 131.44], "杵築市": [33.41, 131.61], "宇佐市": [33.53, 131.35], "豊后大野市": [32.97, 131.58], "由布市": [33.17, 131.42], "国東市": [33.56, 131.73],
            "宮崎市": [31.90, 131.42], "都城市": [31.71, 131.06], "延岡市": [32.58, 131.67], "日南市": [31.60, 131.37], "小林市": [31.99, 130.97], "日向市": [32.42, 131.62], "串間市": [31.46, 131.23], "西都市": [32.11, 131.40], "えびの市": [32.04, 130.82],
            "鹿児島市": [31.59, 130.55], "鹿屋市": [31.37, 130.85], "枕崎市": [31.27, 130.29], "阿久根市": [32.02, 130.19], "出水市": [32.08, 130.35], "指宿市": [31.23, 130.63], "西之表市": [30.73, 130.99], "垂水市": [31.49, 130.70], "薩摩川内市": [31.81, 130.30], "日置市": [31.63, 130.39], "曽於市": [31.66, 130.98], "霧島市": [31.74, 130.76], "いちき串木野市": [31.71, 130.27], "南さつま市": [31.41, 130.32], "志布志市": [31.47, 131.09], "奄美市": [28.37, 129.49], "南九州市": [31.37, 130.43], "伊佐市": [32.05, 130.61], "姶良市": [31.73, 130.62], "屋久島町": [30.34, 130.52], "与論町": [27.04, 128.43], "和泊町": [27.37, 128.66], "知名町": [27.36, 128.60], "徳之島町": [27.73, 129.00], "天城町": [27.73, 128.93], "伊仙町": [27.68, 128.93], "龍郷町": [28.42, 129.60], "喜界町": [28.32, 129.93], "竹富町": [24.33, 123.82], "与那国町": [24.45, 122.98], "久米島町": [26.34, 126.75],
            "那覇市": [26.21, 127.68], "宜野湾市": [26.28, 127.76], "石垣市": [24.34, 124.15], "浦添市": [26.24, 127.72], "名護市": [26.59, 127.97], "糸満市": [26.12, 127.67], "沖縄市": [26.33, 127.80], "豊見城市": [26.17, 127.68], "うるま市": [26.37, 127.85], "宮古島市": [24.80, 125.28], "南城市": [26.15, 127.77]
        };

        function getCoordinates(addrString, prefString) {
            if (!addrString) return null; 
            
            // 1. 完全一致 (都道府県+市町村)
            if (prefString && locationMap[prefString + addrString]) {
                return { lat: locationMap[prefString + addrString][0], lng: locationMap[prefString + addrString][1], isFallback: false };
            }
            // 2. 市町村名のみ
            if (locationMap[addrString]) {
                return { lat: locationMap[addrString][0], lng: locationMap[addrString][1], isFallback: false };
            }
            // 3. 部分一致
            for (const key in locationMap) {
                if (addrString.startsWith(key)) {
                    return { lat: locationMap[key][0], lng: locationMap[key][1], isFallback: false };
                }
            }
            // 4. フォールバック (県庁座標を使いつつ、isFallbackフラグを立てる)
            if (prefString && locationMap[prefString]) {
                return { lat: locationMap[prefString][0], lng: locationMap[prefString][1], isFallback: true };
            }
            return null;
        }

        // 震度に応じたクラスとラベルを取得
        function parseIntensity(scale) {
            let className = 'intensity-unknown', label = '?';
            if (scale === undefined || scale === null || scale === -1) return { className, label };
            if (scale === 10) { className = 'intensity-1'; label = '1'; }
            else if (scale === 20) { className = 'intensity-2'; label = '2'; }
            else if (scale === 30) { className = 'intensity-3'; label = '3'; }
            else if (scale === 40) { className = 'intensity-4'; label = '4'; }
            else if (scale === 45) { className = 'intensity-5-minus'; label = '5-'; }
            else if (scale === 50) { className = 'intensity-5-plus'; label = '5+'; }
            else if (scale === 55) { className = 'intensity-6-minus'; label = '6-'; }
            else if (scale === 60) { className = 'intensity-6-plus'; label = '6+'; }
            else if (scale === 70) { className = 'intensity-7'; label = '7'; }
            return { className, label };
        }

        function formatDate(dateStr) {
            if (!dateStr) return "日時不明";
            const match = dateStr.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})\s+(\d{1,2}):(\d{1,2})/);
            return match ? `${match[1]}年${match[2]}月${match[3]}日 ${match[4]}:${match[5]}頃` : dateStr;
        }

        let historyDataList = [], currentLatestId = null;

        async function fetchLatestQuake(isAutoUpdate = false) {
            if (!isAutoUpdate) document.getElementById('loading').style.display = 'flex';
            try {
                // limitを少し増やして確実にデータを取る
                const [res551, res556, res552] = await Promise.all([
                    fetch('https://api.p2pquake.net/v2/history?codes=551&limit=50', { cache: 'no-store' }),
                    fetch('https://api.p2pquake.net/v2/history?codes=556&limit=50', { cache: 'no-store' }),
                    fetch('https://api.p2pquake.net/v2/history?codes=552&limit=10', { cache: 'no-store' })
                ]);
                if (!res551.ok || !res556.ok || !res552.ok) throw new Error("API Error");

                const data551 = await res551.json();
                const data556 = await res556.json();
                const data552 = await res552.json(); 

                const allData = [...data551, ...data556, ...data552];

                if (allData.length === 0) throw new Error("No Data");

                // 日付降順ソート
                allData.sort((a, b) => b.time.localeCompare(a.time));

                // 重複除去 (551と556で同じ地震IDがある場合、詳細な方を残す)
                const quakeMap = new Map();
                allData.forEach(q => {
                    const key = q.id || q.time;
                    if (!quakeMap.has(key)) {
                        quakeMap.set(key, q);
                    } else {
                        const existing = quakeMap.get(key);
                        if ((existing.code === 551 || existing.code === 556) && (q.code === 551 || q.code === 556)) {
                            const isDetailedNew = (q.earthquake && q.earthquake.hypocenter && q.earthquake.hypocenter.name);
                            const isDetailedExisting = (existing.earthquake && existing.earthquake.hypocenter && existing.earthquake.hypocenter.name);
                            if (!isDetailedExisting && isDetailedNew) quakeMap.set(key, q);
                        }
                    }
                });

                historyDataList = Array.from(quakeMap.values());
                historyDataList.sort((a, b) => b.time.localeCompare(a.time));

                renderHistoryList();

                if (historyDataList.length > 0) {
                    const latestQuake = historyDataList[0];
                    const latestId = latestQuake.id || latestQuake.time; 

                    if (isAutoUpdate) {
                        if (latestId !== currentLatestId) {
                            currentLatestId = latestId;
                            updateUI(latestQuake);
                        }
                    } else {
                        currentLatestId = latestId;
                        updateUI(latestQuake);
                    }
                }
            } catch (error) {
                if (!isAutoUpdate) document.getElementById('infoContent').innerHTML = `<div style="color:var(--danger-color);text-align:center;">Error<br>${error.message}</div>`;
            } finally {
                if (!isAutoUpdate) document.getElementById('loading').style.display = 'none';
            }
        }

        function toggleHistory() { document.getElementById('historyPanel').classList.toggle('open'); }
        function toggleAbout() { document.getElementById('aboutModal').classList.toggle('open'); }

        function renderHistoryList() {
            const listEl = document.getElementById('historyList'); listEl.innerHTML = '';
            historyDataList.forEach((quake, index) => {
                const div = document.createElement('div'); div.className = 'history-item';
                div.style.animationDelay = `${index * 0.05}s`;
                if (index === 0) div.classList.add('active');
                
                div.onclick = () => {
                    updateUI(quake);
                    document.querySelectorAll('.history-item').forEach(el => el.classList.remove('active'));
                    div.classList.add('active');
                    if (window.innerWidth <= 600) toggleHistory();
                };

                let timeStr = "", name = "", metaHtml = "";
                if (quake.code === 552) {
                    timeStr = formatDate(quake.issue.time || quake.time);
                    name = "津波予報" + (quake.cancelled ? " (解除)" : "");
                    metaHtml = `<span class="history-shindo-badge tsunami-badge">TSUNAMI</span>`;
                } else {
                    const eq = quake.earthquake || {}, hypo = eq.hypocenter || quake.hypocenter || {};
                    timeStr = formatDate(eq.time || quake.time);
                    name = hypo.name || '震源調査中';
                    let scale = quake.maxScale !== undefined ? quake.maxScale : eq.maxScale;
                    const maxInt = parseIntensity(scale);
                    let color = '#666';
                    if(scale>=50) color='#ff7300'; else if(scale>=40) color='#f0cc00'; else if(scale>=30) color='#2bba2b'; else if(scale>=10) color='#2679d6';
                    
                    metaHtml = `<span class="history-shindo-badge" style="background-color:${color}">震度${maxInt.label}</span> <span>M${(hypo.magnitude!=-1&&hypo.magnitude?hypo.magnitude.toFixed(1):'-')}</span>`;
                }
                div.innerHTML = `<div class="history-time">${timeStr}</div><div class="history-name">${name}</div><div class="history-meta">${metaHtml}</div>`;
                listEl.appendChild(div);
            });
        }

        function updateUI(data) {
            markerLayer.clearLayers(); epicenterLayer.clearLayers();
            const infoPanel = document.getElementById('infoPanel'), infoContent = document.getElementById('infoContent');
            if (!data) return;

            // --- 津波情報 ---
            if (data.code === 552) {
                infoPanel.style.borderLeftColor = '#1e3a8a';
                let areasHtml = data.areas && data.areas.length > 0 ? '<div class="tsunami-area-list">' + data.areas.map(area => {
                    let gradeClass = 'grade-unknown', gradeLabel = '不明';
                    if (area.grade === 'MajorWarning') { gradeClass = 'grade-major'; gradeLabel = '大津波警報'; }
                    else if (area.grade === 'Warning') { gradeClass = 'grade-warning'; gradeLabel = '津波警報'; }
                    else if (area.grade === 'Watch') { gradeClass = 'grade-watch'; gradeLabel = '津波注意報'; }
                    return `<div class="tsunami-row"><span class="tsunami-grade ${gradeClass}">${gradeLabel}</span>${area.name}</div>`;
                }).join('') + '</div>' : '<div style="padding:10px;font-size:12px;">詳細は気象庁サイト等をご確認ください。</div>';
                
                infoContent.innerHTML = `<div class="info-row"><span class="info-label">発表日時</span><span class="info-value updated">${formatDate(data.issue.time)}</span></div>
                    <div class="info-row"><span class="info-label">情報種別</span><span class="info-value updated" style="color:#3b82f6;">津波予報 ${data.cancelled?'(解除)':''}</span></div>${areasHtml}`;
                map.setView([37.0, 138.0], 5);
                return;
            }

            // --- 地震情報 ---
            const eq = data.earthquake || {}, hypo = eq.hypocenter || data.hypocenter || {};
            let scale = data.maxScale !== undefined ? data.maxScale : eq.maxScale;
            const maxInt = parseIntensity(scale);
            let borderColor = '#666', textColor = 'var(--text-primary)';
            if (scale >= 60) { borderColor = '#a60021'; textColor = '#ff4d4d'; }
            else if (scale >= 50) { borderColor = '#ff7300'; textColor = '#ffcc00'; }
            else if (scale >= 40) { borderColor = '#f0cc00'; }
            else if (scale >= 30) { borderColor = '#2bba2b'; }
            else if (scale >= 10) { borderColor = '#2679d6'; }
            infoPanel.style.borderLeftColor = borderColor;

            let mag = (typeof hypo.magnitude === 'number' && hypo.magnitude !== -1) ? hypo.magnitude.toFixed(1) : '---';
            let depth = (typeof hypo.depth === 'number' && hypo.depth !== -1) ? `約${hypo.depth}km` : (hypo.depth === 0 ? 'ごく浅い' : '---');
            const centerName = hypo.name || '調査中';

            infoContent.innerHTML = `<div class="info-row"><span class="info-label">発生日時</span><span class="info-value updated">${formatDate(eq.time || data.time)}</span></div>
                <div class="info-row"><span class="info-label">震源地</span><span class="info-value updated">${centerName}</span></div>
                <div class="info-row"><span class="info-label">深さ</span><span class="info-value updated">${depth}</span></div>
                <div class="info-row"><span class="info-label">マグニチュード</span><span class="info-value updated">M${mag}</span></div>
                <div class="info-row"><span class="info-label">最大震度</span><span class="info-value max-intensity updated" style="color:${textColor}">震度${maxInt.label}</span></div>`;

            // 震源プロット
            if (hypo.latitude && hypo.longitude && hypo.latitude !== -200) {
                const icon = L.divIcon({ className: 'custom-div-icon', html: `<div class="epicenter-marker"><div class="epicenter-ripple"></div><div class="epicenter-ripple"></div><div class="epicenter-center">✕</div></div>`, iconSize: [80, 80], iconAnchor: [40, 40] });
                L.marker([hypo.latitude, hypo.longitude], { icon: icon, zIndexOffset: 2000 }).addTo(epicenterLayer).bindPopup(`<strong>震源地</strong><br>${centerName}`);
                map.setView([hypo.latitude, hypo.longitude], 6);
            }

            // 震度分布プロット
            if (data.points && Array.isArray(data.points)) {
                data.points.sort((a, b) => b.scale - a.scale);
                const usedAddr = new Set();
                let delayIndex = 0;

                data.points.forEach(point => {
                    const uniqueKey = `${point.pref}_${point.addr}`;
                    if (usedAddr.has(uniqueKey)) return;
                    usedAddr.add(uniqueKey);

                    let coords = getCoordinates(point.addr, point.pref);
                    
                    if (coords) {
                        let lat = coords.lat;
                        let lng = coords.lng;
                        
                        // ★ 団子状態を防ぐための強力なランダム分散ロジック
                        // 正確な座標が見つからない(isFallback)場合、県庁周辺に半径20km〜30kmくらいで散らす
                        if (coords.isFallback) {
                            const angle = Math.random() * Math.PI * 2;
                            // 0.1度 ≒ 11km なので、0.3度 ≒ 30km程度
                            const radius = Math.sqrt(Math.random()) * 0.25; 
                            lat += Math.sin(angle) * radius;
                            lng += Math.cos(angle) * radius * 1.2; // 経度は少し広めに
                        } else {
                            // 正確な座標がある場合も、重なり防止でごくわずかにずらす (約500m)
                            const jitter = 0.005;
                            lat += (Math.random() - 0.5) * jitter;
                            lng += (Math.random() - 0.5) * jitter;
                        }

                        const pInfo = parseIntensity(point.scale);
                        const delay = Math.min(delayIndex * 0.02, 1.5); 
                        delayIndex++;
                        
                        const icon = L.divIcon({ 
                            className: 'custom-div-icon', 
                            html: `<div class="seismic-icon ${pInfo.className}" style="animation-delay:${delay}s">${pInfo.label}</div>`, 
                            iconSize: [24, 24], 
                            iconAnchor: [12, 12] 
                        });
                        
                        L.marker([lat, lng], { icon: icon }).addTo(markerLayer).bindPopup(`<strong>${point.pref}${point.addr}</strong><br>震度${pInfo.label}`);
                    }
                });
            }
        }

        fetchLatestQuake();
        setInterval(() => fetchLatestQuake(true), 5000);
    </script>
</body>
</html>